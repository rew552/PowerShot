# PowerShot v1.0 Readme

## 概要

**PowerShot** は、クリップボードを監視し、スクリーンショットの保存と整理を効率化する常駐型ツールです。

`PrintScreen` キーなどでクリップボードにコピーされた画像を自動で検知し、高機能な UI を持つ保存ウィンドウを表示します。ユーザーはプレビューで画像を確認しながら、保存先のフォルダやファイル名を柔軟に設定できます。

ファイル履歴の検索や連番の自動インクリメント、重複ファイルの警告など、スクリーンショットを多用する作業の生産性を向上させるための機能が多数搭載されています。

## 主な機能

- **クリップボード画像の自動検知:** クリップボードに新しい画像がコピーされると、自動で保存ウィンドウが起動します。
- **高機能な UI:**
  - 取得した画像のプレビュー表示
  - ウィンドウサイズのリサイズに対応
  - ダークモードを基調としたモダンなデザイン
- **柔軟なファイル名設定:**
  - 「接頭辞」「オプション名」「連番」を組み合わせてファイル名を決定
  - ファイル名が指定されない場合は、タイムスタンプ形式で自動保存
  - 連番の自動インクリメントとリセット機能
- **フォルダ管理:**
  - `ScreenShots` フォルダ内にサブフォルダを指定して画像を整理
  - フォルダが存在しない場合は `ScreenShots` フォルダ直下に保存
- **高度な履歴検索:**
  - 指定フォルダ内のファイル名を検索・一覧表示
  - `ScreenShots` フォルダ内のサブフォルダを一覧表示
  - 履歴からファイル名やフォルダ名をダブルクリックで簡単入力
- **重複保存の防止:**
  - 保存しようとしているファイル名が既に存在する場合、履歴リスト上で赤字で警告します。
  - 保存しようとした場合はエラーダイアログが表示されます。

## 確認済動作環境

- Windows PowerShell 5.1 以上
- .NET Framework 4.5 以上

## 使用方法

### 1. 起動

1. `PowerShot.ps1` ファイルを右クリックし、「PowerShell で実行」を選択します。
2. PowerShell のコンソールウィンドウが起動し、「クリップボードの監視を開始しました。」と表示されれば準備完了です。
3. このコンソールは PowerShot の本体です。**閉じずに最小化しておいてください。**

### 2. スクリーンショットの保存

1. `Ctrl + PrintScreen` キーや `Alt + PrintScreen`などでスクリーンショットを撮影し、クリップボードにコピーします。
2. PowerShot が画像を検知し、自動で保存用ウィンドウが表示されます。
3. 以下の項目を設定し、「保存」ボタンをクリックします。（連番でそのまま保存する場合は Enter のみで OK）
   - **フォルダ名 (オプション):** 保存先のサブフォルダ名を指定します。空の場合は `ScreenShots` フォルダ直下に保存されます。
   - **ファイル名 1 (接頭辞):** ファイル名のベースとなる部分です。
   - **ファイル名 2 (オプション):** ファイル名に追加する補足情報です。
   - **連番:** 接頭辞を指定した場合に、ファイル名の末尾に付与される 3 桁の番号です。保存するたびに自動で 1 つ増えます。
   - **形式:** 保存形式を `PNG` または `JPG` から選択します。
4. ウィンドウを閉じるには「キャンセル」をクリックするか、`Esc` キーを押します。

### 3. 終了

1. 最小化しておいた PowerShell のコンソールウィンドウをアクティブにします。
2. `Ctrl + C` を押すと、現在の設定を保存して安全にアプリケーションを終了します。
